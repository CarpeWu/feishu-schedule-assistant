# 🤖 智能日程与效能管理系统 (Feishu Report Automation)

[![n8n Version](https://img.shields.io/badge/n8n-Latest-orange?logo=n8n)](https://n8n.io/)
[![Lark/Feishu](https://img.shields.io/badge/Lark%2FFeishu-API%20v3-blue?logo=lark)](https://open.feishu.cn/)
[![License](https://img.shields.io/badge/License-MIT-green)](LICENSE)

> 一个基于 **n8n** 与 **飞书 (Lark/Feishu)** 深度集成的自动化日程与效能管理系统。实现从智能排班、定时提醒、漏写统计到 AI 深度分析的全链路闭环。

---

## 🚀 核心机制：上下文启动包 (Context Bootstrap)

**本项目不仅仅是一组代码，更是一套完整的“AI 协作开发规范”。**

在 `上下文启动包/` 目录中，封装了驱动本项目**降低 AI 幻觉**、**实现快速开发**、**持续优化**与**低成本维护**的基石。

### 💡 为什么它是基石？

在与 Cursor、ChatGPT 或 Claude 等 AI 辅助编程工具协作时，直接提问往往会导致 AI 产生“幻觉”或生成不符合项目规范的代码。**上下文启动包**通过提供标准化的上下文，解决了这个问题：

1.  **降低 AI 幻觉**: 
    *   `核心知识库文档/` 提供了确定的 API 规范、架构蓝图和节点参数，强制 AI 基于事实而非训练数据的模糊记忆来生成代码。
2.  **快速开发 & 迭代**:
    *   `提示词/` 包含了经过验证的 System Prompts。只需加载这些 Prompt，AI 就能立即变身为熟悉本项目的“资深架构师”，无需从零解释业务逻辑。
3.  **标准化维护**:
    *   无论是新增一个字段，还是修改一个工作流，遵循启动包中的 `架构设计文档` 能确保所有改动都保持系统的一致性，避免“屎山”代码的堆积。

### 📂 启动包包含内容

| 目录/文件 | 作用 | AI 协作指令 |
| :--- | :--- | :--- |
| **`提示词/`** | **AI 的角色设定** | *"你是一个 n8n 专家，请基于[工作流实现主提示词]..."* |
| **`核心知识库文档/API配置`** | **AI 的数据字典** | *"请参考此文档中的 Base Token 和 Table ID..."* |
| **`核心知识库文档/架构设计`** | **AI 的导航图** | *"请根据 WF-04 的设计，实现 Webhook 数据清洗..."* |
| **`核心知识库文档/技术规范`** | **AI 的质检员** | *"确保生成的 JSON 符合[n8n-Feishu 集成规范]..."* |

> **⚠️ 黄金法则**：任何二次开发、Bug 修复或新功能添加，**第一步**永远是将 `上下文启动包` 中的相关文件投喂给你的 AI 助手。

---

## 🧩 模块化工作流 (System Modules)

系统被拆分为 6 个独立的 n8n 工作流，各司其职，解耦运行：

| 编号 | 模块名称 (Workflow) | 核心功能 | 触发方式 |
| :--- | :--- | :--- | :--- |
| **WF-01** | **排班计算引擎** | 计算当日应提交名单，自动识别节假日，写入排班表 | 定时 (每日 20:00) |
| **WF-02** | **提醒与通知服务** | 扫描未提交人员，发送飞书卡片定向催办 | 定时 (每日 21/22/23点) |
| **WF-03** | **漏写判定与记录** | 每日结算，自动标记漏写状态并通知管理员 | 定时 (次日 08:00) |
| **WF-04** | **统一提交处理** | 核心网关，实时接收日报提交/补交事件，清洗数据入库 | Webhook (实时) |
| **WF-05** | **AI 分析服务** | 调用 DeepSeek/LLM 对周报内容进行汇总、情感分析及风险提取 | 定时 (周一 09:00) |
| **WF-06** | **刘总专用提醒** | 针对特定高管的定制化提醒策略 | 定时 (周五 19:00) |

---

## 🛠️ 部署与使用

### 1. 环境准备
*   **n8n**: 版本建议 >= 1.0.0 (Self-hosted 或 Cloud)。
*   **飞书自建应用**: 用于调用多维表格 API 和发送消息。
*   **LLM API**: (可选) 用于 WF-05 的 AI 分析功能。

### 2. 导入工作流
所有工作流 JSON 文件均位于 `已实现工作流/` 目录下。直接将文件导入 n8n 即可。

### 3. 配置凭证与参数
由于项目已进行**隐私脱敏处理**，导入后你需要根据 `上下文启动包/核心知识库文档/智能日程与效能管理系统 - API配置文档 v1.3.0.md` 中的说明，更新以下信息：

1.  **n8n Credentials**: 配置 `Feishu API` 和 `OpenRouter/OpenAI` 凭证。
2.  **常量替换**: 检查工作流中的节点，替换 `cli_xxx` (AppID)、`app_token` 等占位符为你自己的真实数据。

---

## 📂 目录结构

```text
.
├── 上下文启动包/           # [核心] AI 协作开发的基石与知识库
├── 已实现工作流/           # [产物] 可直接导入 n8n 的 JSON 文件
├── 下阶段规划/             # [路线图] 未来功能设计
├── 飞书多维表格结构/        # [数据] 多维表格的结构定义
├── CHANGELOG.md           # 版本变更记录
└── README.md              # 项目说明
```

## 📅 版本信息
当前版本：**v1.3.0**
最后更新：2025-12-11

---
*Built with ❤️ by n8n & Feishu Automation*